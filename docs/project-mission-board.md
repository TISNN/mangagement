# 项目任务控制台（Project Mission Board）设计文档

## 1. 模块定位与目标

- **角色覆盖**：顾问、文书老师、学生、质控、运营经理。
- **核心价值**：
  - 统一管理申请项目全生命周期的任务，兼顾个人视角与团队协作。
  - 打通工作台、材料、网申、质检等模块的任务流，减少信息孤岛。
  - 支持模板化与自动化，提升执行效率与交付质量。

## 2. 顶层信息架构

```
项目任务控制台
├─ 任務总览（Mission Overview）
├─ 任务看板（Kanban Orbit）
├─ 我的任务（My Assignments）
├─ 任务日历（Mission Calendar）
├─ 职责矩阵（Crew Matrix）
└─ 指标分析（Mission Analytics）
```

### 2.1 任務总览（Mission Overview）
- 首页仪表盘：展示总任务数、逾期数、进度完成率、平均响应时长等关键指标。
- 警报中心：列出高优先级/逾期/卡点任务，支持快速指派与提醒。
- 任务热力图：按项目、角色、阶段统计任务密度。

### 2.2 任务看板（Kanban Orbit）
- 看板列：默认阶段为`待认领 → 进行中 → 待审核 → 待学生 → 已完成`，支持自定义。
- 每张任务卡片显示：标题、项目、负责人、负责人角色、截止、关联对象、标签、子任务进度、AI 建议。
- 支持拖拽、批量指派、内嵌评论、@ 通知。

### 2.3 我的任务（My Assignments）
- 个人视图，按优先级/截止时间排序。
- 显示角色身份切换（顾问／文书／质检），提供快筛：`本周到期、待我审批、待学生动作`。
- 支持「番茄钟」或「专注模式」：记录处理时长，输出个人效率报告。

### 2.4 任务日历（Mission Calendar）
- 周/月视图展示任务时间分布。
- 支持拖拽调整截止日期，自动同步相关提醒。
- 可与会议、网申截止时间联动，避免冲突。

### 2.5 职责矩阵（Crew Matrix）
- 行为项目/阶段，列为人员/角色，单元格显示任务数量、完成率、负载情况。
- 可切换视图：`项目 → 任务分布` / `成员 → 工作量热力图`。
- 提供自动化建议：识别超负荷成员、无人负责的阶段。

### 2.6 指标分析（Mission Analytics）
- KPI：任务准时率、平均处理时长、退回率、跨角色协作效率、AI 协助使用率等。
- 维度筛选：项目、时间范围、角色、任务类型。
- 支持导出仪表盘/报告，与 OKR、绩效评估挂钩。

## 3. 核心功能详解

### 3.1 任务模型
- **任务类型**：材料、文书、网申、质检、沟通、会议、其他（可配置）。
- **任务来源**：手动创建、模板实例化、自动触发（材料状态变化/文书提交/网申阶段变更）。
- **关联对象**：学生、顾问、文书、项目、服务、会议记录等。
- **责任机制**：
  - 主负责人：对结果负责。
  - 协同人：可执行子任务。
  - 观察者：可查看但不修改。
- **状态机**：
  - 待认领 → 进行中 → 待审核 → 待学生 → 已完成。
  - 任意节点可退回“待认领/进行中”，记录退回原因。

### 3.2 模板体系
- **模板分类**：国家模板、项目模板、服务模板、阶段模板。
- **模板内容**：
  - 默认任务列表、阶段、优先级、标准完成时长。
  - 依赖关系：例如“文书定稿”依赖“材料确认”“学生反馈”。
  - AI 提示：针对常见场景预设建议。
- **实例化流程**：选择模板 → 绑定学生/项目 → 自动生成任务 → 支持二次编辑。

### 3.3 自动化与提醒
- 触发器：
  - 材料状态变化 → 自动生成质检任务。
  - 网申阶段完成 → 推送下一阶段任务。
  - 文书定稿 → 自动通知学生确认。
- 通知渠道：站内信、邮件、企微/钉钉、移动推送。
- 催办策略：距离截止 48h 自动提醒；逾期后每日提醒；可手动加急。
- 任务 SLA：按任务类型设定 SLA，超时进入“警报中心”。

### 3.4 协同体验
- 任务详情抽屉：
  - 任务描述、验收标准、提交物清单。
  - 评论与讨论（支持富文本、附件、@、表情）。
  - 子任务 & 检查清单。
  - 时间线：创建、更新、状态变更、催办、评论等操作日志。
- AI 助手：
  - 根据历史任务建议拆解与验收标准。
  - 生成任务总结或交接笔记。
  - 提示潜在风险（如待学生补充材料超过3天未响应）。

## 4. 角色与权限

| 角色     | 权限亮点                                                                 |
|----------|--------------------------------------------------------------------------|
| 顾问     | 创建项目任务、指派、审批、同步客户反馈                                   |
| 文书老师 | 查看/执行分配任务、提交成果、申请协助、查看模板                          |
| 学生     | 查看与自己相关任务、提交材料/反馈、查看历史记录                          |
| 质检人员 | 查看所有待审任务、记录评分、退回修改                                     |
| 运营经理 | 管理模板、配置自动化规则、查看分析报表                                   |
| 管理员   | 系统级配置（权限、模板、提醒策略）                                       |

## 5. 数据模型概览（关系简化）

```
application_project
   └─ project_task
        ├─ task_assignment (角色、责任人)
        ├─ task_comment
        ├─ task_checklist
        ├─ task_log (操作历史)
        ├─ task_template_instance
        └─ task_dependency
```

**关键字段说明**：
- `project_task`: id, project_id, title, type, status, priority, due_date, sla_hours, description, created_by, linked_student_id, linked_service_id, automation_source。
- `task_assignment`: task_id, user_id, role(`owner/cooperator/watcher`), is_primary。
- `task_template`: name, description, default_stage, default_role, expected_duration, prerequisites。
- `task_log`: task_id, operator_id, action, payload(json), created_at。

## 6. API 参考（REST 风格）

- `POST /project-tasks`: 创建任务或实例化模板。
- `GET /project-tasks`: 支持分页、过滤（项目、角色、状态、优先级、时间范围）。
- `PATCH /project-tasks/:id`: 更新任务属性、状态、指派、截止时间。
- `POST /project-tasks/:id/comments`: 添加评论，支持附件/引用。
- `POST /project-tasks/:id/checklist`: 新增子任务，支持批量完成。
- `POST /project-tasks/:id/notify`: 触发催办。
- `POST /project-task-templates`: 管理任务模板。
- `GET /project-task-metrics`: 输出任务 KPI 与报表数据。

## 7. 界面线框草图（文本示意）

```
┌──────────────────────────────────────────────┐
│ 顶部：筛选（项目/角色/状态） | 搜索 | 新建任务    │
├──────────────────────────────────────────────┤
│ 仪表盘卡片：总任务/逾期/准时率/平均用时        │
│ 警报区：高优先级待处理列表                    │
│ 热力图：项目 × 阶段任务数量                   │
├──────────────────────────────────────────────┤
│ Tab：看板 | 我的任务 | 日历 | 矩阵 | 分析        │
├──────────────────────────────────────────────┤
│ 看板视图示例                                  │
│ ┌────────────┬────────────┬──────────────┐ │
│ │ 待认领      │ 进行中      │ 待审核         │ │
│ │ 卡片：标题  │ 卡片：标题  │ 卡片：标题       │ │
│ │ 负责人/截止 │ 负责人/截止 │ 负责人/截止       │ │
│ └────────────┴────────────┴──────────────┘ │
│ 侧边抽屉：任务详情 / 评论 / 子任务 / 日志      │
└──────────────────────────────────────────────┘
```

## 8. 交互细节

- **拖拽与批量操作**：支持按 `Shift` 多选后批量指派、批量变更阶段。
- **快捷创建**：在看板空白区域双击即可创建任务；可从模板快速添加。
- **智能排序**：自动依据优先级（紧急>重要>普通）+ deadline 排序，结合个人偏好可自定义。
- **协同提示**：同一任务多人编辑时弹出实时提示；展示当前在线协作者头像。
- **子任务进度条**：当子任务完成度 `< 50%` 时显示黄色提示，`≥80%` 显示绿色。

## 9. 自动化规则示例

| 触发条件                              | 动作                                                                 |
|---------------------------------------|----------------------------------------------------------------------|
| 文书状态改为“待审核”                 | 创建“质检-文书审核”任务，指派质检角色，截止时间 = 当前 + 24h           |
| 材料状态“待学生补充”超过 48h 未更新   | 自动提醒学生 + 顾问，并推送至警报中心                                 |
| 网申阶段完成                          | 自动生成下一阶段任务并指派责任人                                      |
| 学生反馈满意度 < 3 分                 | 自动创建跟进任务并指派顾问，提醒 24h 内回访                           |

## 10. KPI 与成功标准

- 任务准时率 ≥ 90%，逾期率逐月下降。
- 平均处理时长减少 X%，退回率下降 Y%。
- 每位顾问每日手动任务创建数量下降（模板与自动化占比提升）。
- 学生反馈中的“沟通及时度”评分提升。
- 任务质检通过率与 AI 建议采纳率统计。

## 11. 迭代路线建议

1. **MVP**：看板 + 我的任务 + 任务详情抽屉 + 基础模板。
2. **自动化**：接入材料/文书/网申状态，支持自动创建与提醒。
3. **分析报表**：上线 KPI 仪表盘、热力图、角色负载视图。
4. **移动端体验**：适配小屏看板与任务详情，支持移动提醒。
5. **智能助手**：引入 AI 任务拆解、风险预测、总结输出。

---

如需进一步提供高保真原型、API 规格或数据库迁移脚本，可在此基础上继续深化。

