# Scheduling & Classroom 功能设计

## 1. 定位与目标
- 统一管理课程排期、班级、教师、教室与线上教室资源。
- 提升课表编排效率，降低冲突，保障教学资源最大化利用。

## 2. 核心用户
- 教务排课老师
- 教学主管、项目负责人
- 任课老师（查看课表、调课申请）
- 学员与家长（查看课表、请假补课）

## 3. 业务流程
1. **需求收集**：课程 SKU、报名人数、授课老师可用时间。
2. **排课规划**：生成排课草案，校验资源冲突。
3. **发布课表**：确认后同步老师、学员、教室日历。
4. **执行监控**：签到、请假、调课、补课安排。
5. **课消统计**：实时扣减课时包，计算课耗成本。

## 4. 功能清单
### 4.1 班级与课表管理
- 班级档案：课程、级别、人数上限、班主任、任课老师
- 课表视图：周视图、月视图、课程视图、资源视图
- 一键复制历史班级课表，适配新学期

### 4.2 排课引擎
- 冲突检测：老师重复、教室重复、学员冲突
- 约束条件：老师偏好时段、教室容量、课程连续性、节假日、中国考试季
- 自动优化建议：根据学习计划分配课时，匹配师资等级

### 4.3 资源管理
- 教师资源：可授课项目、资质、时薪、日历空闲
- 教室资源：线下教室容量、地点、设备；线上会议室链接
- 资源日历：下周资源使用率、闲置时间提醒

### 4.4 调课与请假
- 老师/学员请假流程：审批、候补老师、补课安排
- 调课记录：原因、变更人、通知范围
- 支持课时自动扣减/返还

### 4.5 通知与同步
- 与邮件、短信、企业微信、钉钉同步课表
- 支持导出 iCal / Google Calendar
- 突发调整实时推送

### 4.6 课时统计与结算
- 班级课耗：已上课时、缺勤课时、补课安排
- 老师课时费结算：已上课时、调课、请假代课
- 学员课时消费：剩余课时提醒、补课券

## 5. 数据结构要点
- `Class`: {id, programId, skuId, capacity, status}
- `ScheduleSlot`: {id, classId, teacherId, roomId, startTime, endTime}
- `ResourceCalendar`: {resourceId, resourceType, availabilityBlocks}
- `AttendanceRecord`: {slotId, participantId, role, status}
- `ScheduleChange`: {slotId, changeType, originalTime, newTime, reason}

## 6. 集成需求
- 与 Course Catalog 获取课程课时、授课形式要求
- 与 Tutor Portal 同步老师课表、调课通知
- 与 Learner Portal 同步学员排课、补课安排
- 与财务系统对接老师课时费、教室租赁成本

## 7. KPI 与监控
- 课表冲突率、调课率、课时利用率
- 老师出勤率、准时率、代课频次
- 教室利用率、线上房间占用率
- 学员缺勤率、补课完成率

## 8. 迭代方向
- 引入自动排课算法（基于约束满足 + 优化）
- 智能预警：高风险班级（老师紧张、学员频繁请假）
- 与外部直播平台深度对接（自动创建会议、录制上传）
- 排课可视化分析（热力图、冲突预测、资源预测）
