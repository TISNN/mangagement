# çŸ¥è¯†åº“æ¨¡å—å®ç°æŠ¥å‘Š

## ğŸ“‹ æ¦‚è¿°

æˆåŠŸå°†çŸ¥è¯†åº“é¡µé¢é‡æ„ä¸ºå®Œæ•´çš„æ¨¡å—åŒ–ç»“æ„ï¼Œä½¿ç”¨Supabaseæ•°æ®åº“æ›¿ä»£ç¡¬ç¼–ç æ•°æ®ï¼Œå¤§å¹…æå‡äº†ä»£ç å¯ç»´æŠ¤æ€§å’ŒåŠŸèƒ½æ‰©å±•æ€§ã€‚

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“è®¾è®¡ âœ“
åˆ›å»ºäº†å®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„ï¼š
- **knowledge_resources**: èµ„æºä¸»è¡¨ï¼ˆæ”¯æŒæ–‡æ¡£ã€è§†é¢‘ã€æ–‡ç« ã€æ¨¡æ¿ï¼‰
- **knowledge_comments**: è¯„è®ºè¡¨ï¼ˆæ”¯æŒåµŒå¥—å›å¤ï¼‰
- **knowledge_bookmarks**: æ”¶è—è¡¨
- **knowledge_comment_likes**: è¯„è®ºç‚¹èµè¡¨

**è¿ç§»æ–‡ä»¶**: `database_migrations/004_create_knowledge_base_tables.sql`

### 2. æ¨¡å—åŒ–ç›®å½•ç»“æ„ âœ“
å‚è€ƒ TaskManagement çš„ç»“æ„ï¼Œåˆ›å»ºäº†æ¸…æ™°çš„æ¨¡å—ç»„ç»‡ï¼š

```
KnowledgeBase/
â”œâ”€â”€ components/              # UIç»„ä»¶
â”‚   â”œâ”€â”€ ResourceCard/       # èµ„æºå¡ç‰‡
â”‚   â”œâ”€â”€ ResourceFilters/    # ç­›é€‰å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ ResourceDetailPage/ # è¯¦æƒ…é¡µ
â”‚   â””â”€â”€ StatsCards/         # ç»Ÿè®¡å¡ç‰‡
â”œâ”€â”€ hooks/                   # è‡ªå®šä¹‰Hooks
â”‚   â”œâ”€â”€ useKnowledgeData.ts          # æ•°æ®åŠ è½½
â”‚   â”œâ”€â”€ useKnowledgeFilters.ts       # ç­›é€‰é€»è¾‘
â”‚   â”œâ”€â”€ useKnowledgeOperations.ts    # CRUDæ“ä½œ
â”‚   â””â”€â”€ useKnowledgeComments.ts      # è¯„è®ºç®¡ç†
â”œâ”€â”€ types/                   # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ knowledge.types.ts
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ knowledgeConstants.ts  # å¸¸é‡é…ç½®
â”‚   â””â”€â”€ knowledgeMappers.ts    # æ•°æ®æ˜ å°„
â”œâ”€â”€ index.tsx               # ä¸»å…¥å£
â””â”€â”€ README.md              # æ¨¡å—æ–‡æ¡£
```

### 3. æœåŠ¡å±‚å®ç° âœ“
**æ–‡ä»¶**: `src/services/knowledgeService.ts`

å®Œæ•´å®ç°äº†ï¼š
- âœ… èµ„æºCRUDæ“ä½œ
- âœ… è¯„è®ºCRUDæ“ä½œ
- âœ… æ”¶è—/å–æ¶ˆæ”¶è—
- âœ… ç‚¹èµ/å–æ¶ˆç‚¹èµ
- âœ… æµè§ˆå’Œä¸‹è½½ç»Ÿè®¡
- âœ… ç›¸å…³èµ„æºæ¨è
- âœ… ç»Ÿè®¡æ•°æ®è®¡ç®—

### 4. è‡ªå®šä¹‰Hooks âœ“
- **useKnowledgeData**: ç»Ÿä¸€ç®¡ç†èµ„æºæ•°æ®åŠ è½½å’ŒçŠ¶æ€
- **useKnowledgeFilters**: å¤„ç†å¤æ‚çš„ç­›é€‰å’Œæ’åºé€»è¾‘
- **useKnowledgeOperations**: å°è£…æ‰€æœ‰CRUDæ“ä½œ
- **useKnowledgeComments**: ç®¡ç†è¯„è®ºçš„å¢åˆ æ”¹æŸ¥å’Œç‚¹èµ

### 5. UIç»„ä»¶ âœ“
- **ResourceCard**: ç²¾ç¾çš„èµ„æºå¡ç‰‡ï¼Œæ”¯æŒé¢„è§ˆã€æ”¶è—ã€ä¸‹è½½
- **ResourceFilters**: å¼ºå¤§çš„ç­›é€‰ç»„ä»¶ï¼Œæ”¯æŒå¤šç»´åº¦ç­›é€‰
- **ResourceDetailPage**: å®Œæ•´çš„è¯¦æƒ…é¡µï¼ŒåŒ…å«è¯„è®ºå’Œç›¸å…³æ¨è
- **StatsCards**: ç»Ÿè®¡æ•°æ®å¯è§†åŒ–å±•ç¤º

### 6. æ ¸å¿ƒåŠŸèƒ½ âœ“
- âœ… èµ„æºåˆ—è¡¨å±•ç¤ºï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰
- âœ… å¤šç»´åº¦ç­›é€‰ï¼ˆæœç´¢ã€åˆ†ç±»ã€ç±»å‹ã€ä½œè€…ã€æ ‡ç­¾ã€æ—¶é—´ï¼‰
- âœ… å¤šç§æ’åºæ–¹å¼
- âœ… èµ„æºæ”¶è—/å–æ¶ˆæ”¶è—
- âœ… æµè§ˆé‡å’Œä¸‹è½½é‡ç»Ÿè®¡
- âœ… è¯„è®ºç³»ç»Ÿï¼ˆæ”¯æŒåµŒå¥—å›å¤ï¼‰
- âœ… è¯„è®ºç‚¹èµ
- âœ… ç›¸å…³èµ„æºæ¨è
- âœ… ç²¾é€‰èµ„æºæ ‡è®°
- âœ… æ ‡ç­¾ç³»ç»Ÿ

## ğŸ“Š æŠ€æœ¯äº®ç‚¹

### 1. **å…³æ³¨ç‚¹åˆ†ç¦»**
- **æœåŠ¡å±‚**: æ‰€æœ‰æ•°æ®åº“æ“ä½œé›†ä¸­åœ¨ `knowledgeService.ts`
- **ä¸šåŠ¡é€»è¾‘å±‚**: ä½¿ç”¨è‡ªå®šä¹‰Hookså°è£…ä¸šåŠ¡é€»è¾‘
- **å±•ç¤ºå±‚**: çº¯UIç»„ä»¶ï¼Œåªè´Ÿè´£å±•ç¤º

### 2. **ç±»å‹å®‰å…¨**
- å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- æ•°æ®åº“æ¨¡å‹å’ŒUIæ¨¡å‹åˆ†ç¦»
- ç±»å‹å®‰å…¨çš„æ•°æ®æ˜ å°„å·¥å…·

### 3. **æ•°æ®æ˜ å°„**
- `convertDbResourceToUiResource`: æ•°æ®åº“ â†’ UI
- `convertUiResourceToDbResource`: UI â†’ æ•°æ®åº“
- `buildCommentTree`: æ‰å¹³è¯„è®º â†’ æ ‘å½¢ç»“æ„

### 4. **çŠ¶æ€ç®¡ç†**
- ä½¿ç”¨React Hooksç»Ÿä¸€ç®¡ç†çŠ¶æ€
- é¿å…prop drilling
- çŠ¶æ€æ›´æ–°é€»è¾‘æ¸…æ™°

### 5. **ç”¨æˆ·ä½“éªŒ**
- ä¹è§‚æ›´æ–°ï¼ˆç‚¹èµç­‰æ“ä½œï¼‰
- åŠ è½½çŠ¶æ€æç¤º
- é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ
- å“åº”å¼è®¾è®¡
- æš—é»‘æ¨¡å¼æ”¯æŒ

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: æ‰§è¡Œæ•°æ®åº“è¿ç§»
åœ¨ Supabase Dashboard çš„ SQL Editor ä¸­æ‰§è¡Œï¼š
```sql
database_migrations/004_create_knowledge_base_tables.sql
```

### æ­¥éª¤ 2: éªŒè¯è¡¨åˆ›å»º
ç¡®è®¤ä»¥ä¸‹è¡¨å·²åˆ›å»ºå¹¶åŒ…å«ç¤ºä¾‹æ•°æ®ï¼š
- âœ… knowledge_resources (10æ¡ç¤ºä¾‹æ•°æ®)
- âœ… knowledge_comments
- âœ… knowledge_bookmarks  
- âœ… knowledge_comment_likes

### æ­¥éª¤ 3: é…ç½®RLSï¼ˆå¯é€‰ï¼‰
æ ¹æ®éœ€è¦åœ¨Supabaseä¸­é…ç½®è¡Œçº§å®‰å…¨ç­–ç•¥ã€‚

### æ­¥éª¤ 4: å¯åŠ¨åº”ç”¨
```bash
npm run dev
```

### æ­¥éª¤ 5: æµ‹è¯•åŠŸèƒ½
- è®¿é—® `/admin/knowledge` æŸ¥çœ‹èµ„æºåˆ—è¡¨
- æµ‹è¯•æœç´¢å’Œç­›é€‰åŠŸèƒ½
- ç‚¹å‡»èµ„æºæŸ¥çœ‹è¯¦æƒ…é¡µ
- æµ‹è¯•è¯„è®ºã€æ”¶è—ã€ç‚¹èµåŠŸèƒ½

## ğŸ“„ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
```
src/pages/admin/KnowledgeBase/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ResourceCard/index.tsx
â”‚   â”œâ”€â”€ ResourceFilters/index.tsx
â”‚   â”œâ”€â”€ ResourceDetailPage/index.tsx
â”‚   â””â”€â”€ StatsCards/index.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useKnowledgeData.ts
â”‚   â”œâ”€â”€ useKnowledgeFilters.ts
â”‚   â”œâ”€â”€ useKnowledgeOperations.ts
â”‚   â””â”€â”€ useKnowledgeComments.ts
â”œâ”€â”€ types/
â”‚   â””â”€â”€ knowledge.types.ts
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ knowledgeConstants.ts
â”‚   â””â”€â”€ knowledgeMappers.ts
â”œâ”€â”€ index.tsx
â””â”€â”€ README.md

src/services/
â””â”€â”€ knowledgeService.ts

database_migrations/
â””â”€â”€ 004_create_knowledge_base_tables.sql
```

### åˆ é™¤æ–‡ä»¶
```
src/pages/admin/KnowledgePage.tsx (æ—§çš„ç¡¬ç¼–ç é¡µé¢)
```

### ä¿®æ”¹æ–‡ä»¶
```
src/AppRoutes.tsx (æ›´æ–°è·¯ç”±é…ç½®)
src/pages/admin/KnowledgeDetailPage.tsx (é‡å®šå‘åˆ°æ–°ç»„ä»¶)
```

## ğŸ¯ ä¸TaskManagementçš„å¯¹æ¯”

| ç‰¹æ€§ | TaskManagement | KnowledgeBase |
|------|----------------|---------------|
| ç›®å½•ç»“æ„ | âœ… æ¨¡å—åŒ– | âœ… æ¨¡å—åŒ– |
| è‡ªå®šä¹‰Hooks | âœ… | âœ… |
| ç±»å‹å®šä¹‰ | âœ… | âœ… |
| å·¥å…·å‡½æ•° | âœ… | âœ… |
| ç»„ä»¶åŒ– | âœ… | âœ… |
| æœåŠ¡å±‚ | âœ… | âœ… |
| æ•°æ®æ˜ å°„ | âœ… | âœ… |
| çŠ¶æ€ç®¡ç† | âœ… | âœ… |

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### åœ¨å…¶ä»–é¡µé¢ä½¿ç”¨çŸ¥è¯†åº“ç»„ä»¶

```tsx
// ä½¿ç”¨èµ„æºå¡ç‰‡
import { ResourceCard } from './pages/admin/KnowledgeBase/components/ResourceCard';

<ResourceCard
  resource={resource}
  onView={(id) => navigate(`/admin/knowledge/detail/${id}`)}
  onBookmark={handleBookmark}
  onDownload={handleDownload}
/>

// ä½¿ç”¨æ•°æ®Hook
import { useKnowledgeData } from './pages/admin/KnowledgeBase/hooks/useKnowledgeData';

const { resources, loading, refreshData } = useKnowledgeData();

// ä½¿ç”¨ç­›é€‰Hook
import { useKnowledgeFilters } from './pages/admin/KnowledgeBase/hooks/useKnowledgeFilters';

const { filteredResources, filters, updateFilter } = useKnowledgeFilters(resources);
```

## ğŸ”® æœªæ¥æ‰©å±•

ä»¥ä¸‹åŠŸèƒ½å·²é¢„ç•™æ¥å£ï¼Œå¯å¿«é€Ÿå®ç°ï¼š

1. **æ–‡ä»¶ä¸Šä¼ **: é›†æˆSupabase Storage
2. **èµ„æºåˆ›å»ºè¡¨å•**: ä½¿ç”¨å·²æœ‰çš„hookså’Œservice
3. **èµ„æºç¼–è¾‘åŠŸèƒ½**: ä½¿ç”¨`handleUpdateResource`
4. **æƒé™ç®¡ç†**: åŸºäºç”¨æˆ·è§’è‰²çš„èµ„æºè®¿é—®æ§åˆ¶
5. **å¯¼å‡ºåŠŸèƒ½**: æ‰¹é‡å¯¼å‡ºèµ„æº
6. **åˆ†äº«åŠŸèƒ½**: ç”Ÿæˆåˆ†äº«é“¾æ¥
7. **æ ‡ç­¾ç®¡ç†**: æ ‡ç­¾çš„CRUDæ“ä½œ

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

1. **æ‡’åŠ è½½**: ä½¿ç”¨React.lazyåŠ¨æ€åŠ è½½ç»„ä»¶
2. **è™šæ‹Ÿæ»šåŠ¨**: å¤§é‡èµ„æºæ—¶ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨
3. **ç¼“å­˜ç­–ç•¥**: å®ç°èµ„æºç¼“å­˜
4. **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨CDNå’Œå›¾ç‰‡å‹ç¼©
5. **åˆ†é¡µåŠ è½½**: å®ç°æ— é™æ»šåŠ¨æˆ–åˆ†é¡µ

## âœ¨ æ€»ç»“

æˆåŠŸå°†çŸ¥è¯†åº“ä»ç¡¬ç¼–ç æ•°æ®è¿ç§»åˆ°å®Œæ•´çš„Supabaseæ•°æ®åº“é©±åŠ¨çš„æ¨¡å—åŒ–åº”ç”¨ï¼Œä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§å¾—åˆ°æ˜¾è‘—æå‡ã€‚æ•´ä¸ªæ¨¡å—å‚è€ƒäº†TaskManagementçš„æœ€ä½³å®è·µï¼Œå…·æœ‰ï¼š

- âœ… æ¸…æ™°çš„ç›®å½•ç»“æ„
- âœ… å®Œå–„çš„ç±»å‹å®šä¹‰
- âœ… å¯å¤ç”¨çš„Hooks
- âœ… è§£è€¦çš„ç»„ä»¶è®¾è®¡
- âœ… ç»Ÿä¸€çš„æœåŠ¡å±‚
- âœ… å®Œæ•´çš„åŠŸèƒ½å®ç°

**å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥ç«‹å³éƒ¨ç½²ä½¿ç”¨ï¼** ğŸ‰

