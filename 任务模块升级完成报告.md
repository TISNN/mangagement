# ä»»åŠ¡æ¨¡å—åŸŸå’Œå…³è”å¯¹è±¡å‡çº§ - å®ŒæˆæŠ¥å‘Š

## ğŸ“… é¡¹ç›®ä¿¡æ¯
- **å®Œæˆæ—¥æœŸ**: 2025-11-02
- **ç‰ˆæœ¬**: v2.0
- **çŠ¶æ€**: âœ… æ‰€æœ‰å¼€å‘å·¥ä½œå·²å®Œæˆ

---

## ğŸ¯ é¡¹ç›®ç›®æ ‡å›é¡¾

### ä¸šåŠ¡èƒŒæ™¯
ä»»åŠ¡æ¨¡å—éœ€è¦åŒæ—¶è¦†ç›–å­¦ç”Ÿè·Ÿè¿›ã€å†…éƒ¨è¿è¥ã€å¸‚åœºç­‰å¤šæ¡ä¸šåŠ¡çº¿ï¼ŒåŸæœ‰æ•°æ®ç»“æ„ä»…æ”¯æŒå•ä¸€ `related_student_id`ï¼Œéš¾ä»¥åŒºåˆ†ä»»åŠ¡å½’å±ã€‚

### å‡çº§ç›®æ ‡
1. âœ… å¼•å…¥ç»Ÿä¸€çš„"ä»»åŠ¡åŸŸ + å…³è”å¯¹è±¡"æ¨¡å‹
2. âœ… ä¼˜åŒ–ä»»åŠ¡è¡¨å•/è¯¦æƒ…ä½“éªŒ
3. âœ… ä¸ºAIåŠ©ç†ã€SLAå‘Šè­¦ç­‰é«˜çº§åŠŸèƒ½æä¾›æ•°æ®åŸºç¡€
4. âœ… ä¿æŒæ—§æ•°æ®å¯è¯»ï¼Œå¹³æ»‘è¿‡æ¸¡

---

## âœ… å·²å®Œæˆå·¥ä½œæ¸…å•

### 1. æ•°æ®åº“å±‚ âœ…

#### è¿ç§»SQLè„šæœ¬
**æ–‡ä»¶**: `database_migrations/001_add_task_domain_and_linked_entity.sql`

**æ–°å¢å­—æ®µ**:
- âœ… `task_domain` VARCHAR(50) - ä»»åŠ¡åŸŸ
  - `general` - é€šç”¨ä»»åŠ¡
  - `student_success` - å­¦ç”ŸæœåŠ¡
  - `company_ops` - å…¬å¸è¿è¥
  - `marketing` - å¸‚åœºè¥é”€

- âœ… `linked_entity_type` VARCHAR(20) - å…³è”å®ä½“ç±»å‹
  - `student` - å­¦ç”Ÿ
  - `lead` - çº¿ç´¢
  - `employee` - å‘˜å·¥
  - `none` - æ— å…³è”

- âœ… `linked_entity_id` INTEGER - å…³è”å®ä½“ID

**æ€§èƒ½ä¼˜åŒ–**:
- âœ… åˆ›å»º `idx_tasks_domain` ç´¢å¼•
- âœ… åˆ›å»º `idx_tasks_linked_entity` å¤åˆç´¢å¼•
- âœ… åˆ›å»º `idx_tasks_domain_status` å¤åˆç´¢å¼•

**æ•°æ®å®Œæ•´æ€§**:
- âœ… å­—æ®µçº¦æŸ (CHECK)
- âœ… å…³è”ä¸€è‡´æ€§çº¦æŸ
- âœ… è‡ªåŠ¨è§¦å‘å™¨æ›´æ–° updated_at

**ç»Ÿè®¡è§†å›¾**:
- âœ… `task_stats_by_domain` - æŒ‰ä»»åŠ¡åŸŸç»Ÿè®¡è§†å›¾
- âœ… `task_stats_by_entity_type` - æŒ‰å…³è”ç±»å‹ç»Ÿè®¡è§†å›¾

**å†å²æ•°æ®å›å¡«**:
- âœ… è‡ªåŠ¨å°†æœ‰ `related_student_id` çš„ä»»åŠ¡å½’ç±»ä¸º `student_success`
- âœ… è‡ªåŠ¨å°†æœ‰ `related_lead_id` çš„ä»»åŠ¡å½’ç±»ä¸º `marketing`
- âœ… åŸºäºå…³é”®è¯çš„æ™ºèƒ½åˆ†ç±»ï¼ˆè¿è¥ã€å¸‚åœºç­‰ï¼‰

#### è¿ç§»å·¥å…·
**æ–‡ä»¶**: 
- `database_migrations/run_migration.js` - è¿ç§»çŠ¶æ€æ£€æŸ¥å·¥å…·
- `database_migrations/auto_migrate.js` - è‡ªåŠ¨è¿ç§»å°è¯•å·¥å…·

**åŠŸèƒ½**:
- âœ… è‡ªåŠ¨æ£€æµ‹è¿ç§»çŠ¶æ€
- âœ… æä¾›å¤šç§æ‰§è¡Œæ–¹å¼æŒ‡å¯¼
- âœ… æ•°æ®åˆ†å¸ƒç»Ÿè®¡
- âœ… å›å¡«çŠ¶æ€éªŒè¯

---

### 2. ç±»å‹å®šä¹‰å±‚ âœ…

**æ–‡ä»¶**: `src/pages/admin/TaskManagement/types/task.types.ts`

**TaskFilters æ¥å£æ‰©å±•**:
```typescript
export interface TaskFilters {
  search: string;
  status: string | null;
  priority: string | null;
  assignee: string | null;
  student: string | null;
  tag: string | null;
  timeView: 'all' | 'today' | 'tomorrow' | 'week' | 'expired';
  domain: TaskDomain | null;                        // âœ… æ–°å¢
  relatedEntityType: TaskRelatedEntityType | null;  // âœ… æ–°å¢
}
```

---

### 3. ç­›é€‰é€»è¾‘å±‚ âœ…

**æ–‡ä»¶**: `src/pages/admin/TaskManagement/hooks/useTaskFilters.ts`

**æ–°å¢åŠŸèƒ½**:
- âœ… ä»»åŠ¡åŸŸè¿‡æ»¤é€»è¾‘
- âœ… å…³è”å¯¹è±¡ç±»å‹è¿‡æ»¤é€»è¾‘
- âœ… åˆå§‹çŠ¶æ€åŒ…å«æ–°å­—æ®µ
- âœ… é‡ç½®å‡½æ•°åŒ…å«æ–°å­—æ®µ

**ä»£ç å®ç°**:
```typescript
// 7. ä»»åŠ¡åŸŸè¿‡æ»¤
if (filters.domain && task.domain !== filters.domain) {
  return false;
}

// 8. å…³è”å¯¹è±¡ç±»å‹è¿‡æ»¤
if (filters.relatedEntityType) {
  if (!task.relatedEntityType || task.relatedEntityType !== filters.relatedEntityType) {
    return false;
  }
}
```

---

### 4. UIç»„ä»¶å±‚ âœ…

#### 4.1 TaskFilters ç»„ä»¶
**æ–‡ä»¶**: `src/pages/admin/TaskManagement/components/TaskFilters/index.tsx`

**æ–°å¢ç­›é€‰å™¨**:
- âœ… ä»»åŠ¡åŸŸä¸‹æ‹‰æ¡†
  - é€šç”¨ä»»åŠ¡
  - å­¦ç”ŸæœåŠ¡
  - å…¬å¸è¿è¥
  - å¸‚åœºè¥é”€

- âœ… å…³è”å¯¹è±¡ç±»å‹ä¸‹æ‹‰æ¡†
  - å…³è”å­¦ç”Ÿ
  - å…³è”çº¿ç´¢
  - å…³è”å‘˜å·¥
  - æ— å…³è”

**å·²é€‰ç­›é€‰æ ‡ç­¾**:
- âœ… ä»»åŠ¡åŸŸæ ‡ç­¾ (é’è‰² Cyan)
- âœ… å…³è”ç±»å‹æ ‡ç­¾ (è“ç»¿è‰² Teal)
- âœ… å­¦ç”Ÿç­›é€‰æ ‡ç­¾ (é›è“è‰² Indigo)
- âœ… ä¸€é”®æ¸…é™¤æŒ‰é’®

#### 4.2 TaskStats ç»„ä»¶
**æ–‡ä»¶**: `src/pages/admin/TaskManagement/components/TaskStats/index.tsx`

**æ–°å¢ç»Ÿè®¡æ¨¡å—**:
- âœ… æŒ‰ä»»åŠ¡åŸŸåˆ†å¸ƒç»Ÿè®¡é¢æ¿
- âœ… 4ä¸ªä»»åŠ¡åŸŸå¡ç‰‡å±•ç¤º
  - é€šç”¨ä»»åŠ¡ (ç°è‰² - Briefcase å›¾æ ‡)
  - å­¦ç”ŸæœåŠ¡ (è“è‰² - Users å›¾æ ‡)
  - å…¬å¸è¿è¥ (ç´«è‰² - Building2 å›¾æ ‡)
  - å¸‚åœºè¥é”€ (ç²‰è‰² - Megaphone å›¾æ ‡)
- âœ… ç™¾åˆ†æ¯”å æ¯”æ˜¾ç¤º
- âœ… å“åº”å¼å¸ƒå±€

#### 4.3 TaskTable ç»„ä»¶
**æ–‡ä»¶**: `src/pages/admin/TaskManagement/components/TaskTable/index.tsx`

**æ›´æ–°å†…å®¹**:
- âœ… æ·»åŠ "ä»»åŠ¡åŸŸ"åˆ—
- âœ… æ˜¾ç¤ºä»»åŠ¡åŸŸå›¾æ ‡å’Œæ ‡ç­¾
- âœ… "å…³è”å­¦ç”Ÿ"æ”¹ä¸º"å…³è”å¯¹è±¡"
- âœ… æ”¯æŒæ˜¾ç¤ºå­¦ç”Ÿ/çº¿ç´¢/å…¶ä»–å…³è”å¯¹è±¡
- âœ… çº¿ç´¢æ ‡è¯†ä½¿ç”¨ç²‰è‰²ä¸»é¢˜

#### 4.4 KanbanView ç»„ä»¶
**æ–‡ä»¶**: `src/pages/admin/TaskManagement/components/KanbanView/index.tsx`

**æ–°å¢è§†è§‰å…ƒç´ **:
- âœ… ä»»åŠ¡åŸŸå¾½ç« æ˜¾ç¤ºåœ¨å¡ç‰‡é¡¶éƒ¨
- âœ… å…³è”å¯¹è±¡ä¿¡æ¯æ˜¾ç¤ºï¼ˆå­¦ç”Ÿ/çº¿ç´¢åç§°ï¼‰
- âœ… çº¿ç´¢ç‰¹æ®Šæ ‡è¯†
- âœ… å›¾æ ‡å’Œé¢œè‰²åŒºåˆ†

#### 4.5 CalendarView ç»„ä»¶
**æ–‡ä»¶**: `src/pages/admin/TaskManagement/components/CalendarView/index.tsx`

**æ–°å¢è§†è§‰å…ƒç´ **:
- âœ… ä»»åŠ¡åŸŸä½¿ç”¨å·¦ä¾§å½©è‰²è¾¹æ¡†æ ‡è¯†
  - è“è‰² - å­¦ç”ŸæœåŠ¡
  - ç´«è‰² - å…¬å¸è¿è¥
  - ç²‰è‰² - å¸‚åœºè¥é”€
  - ç°è‰² - é€šç”¨ä»»åŠ¡
- âœ… æ‚¬æµ®æç¤ºæ˜¾ç¤ºä»»åŠ¡åŸŸ
- âœ… æ˜¾ç¤ºå…³è”å¯¹è±¡åç§°

#### 4.6 LegacyTaskBanner ç»„ä»¶ï¼ˆæ–°åˆ›å»ºï¼‰
**æ–‡ä»¶**: `src/pages/admin/TaskManagement/components/LegacyTaskBanner/index.tsx`

**åŠŸèƒ½**:
- âœ… è‡ªåŠ¨æ£€æµ‹ç¼ºå°‘åŸŸ/å…³è”ä¿¡æ¯çš„ä»»åŠ¡
- âœ… æ˜¾ç¤ºç»Ÿè®¡æ•°æ®å’Œæç¤ºä¿¡æ¯
- âœ… æ”¯æŒå…³é—­æ¨ªå¹…ï¼ˆæœ¬åœ°å­˜å‚¨è®°å¿†ï¼‰
- âœ… ç¥ç€è‰²ä¸»é¢˜ï¼Œé†’ç›®ä½†ä¸åˆºçœ¼

---

### 5. ä¸»é¡µé¢é›†æˆ âœ…

**æ–‡ä»¶**: `src/pages/admin/TaskManagement/index.tsx`

**é›†æˆå†…å®¹**:
- âœ… å¯¼å…¥ LegacyTaskBanner ç»„ä»¶
- âœ… æ·»åŠ æ¨ªå¹…æ˜¾ç¤ºçŠ¶æ€ç®¡ç†
- âœ… æœ¬åœ°å­˜å‚¨è®°å¿†ç”¨æˆ·å…³é—­çŠ¶æ€
- âœ… ç»Ÿè®¡é¢æ¿ä¸‹æ–¹æ˜¾ç¤ºæ¨ªå¹…

---

## ğŸ¨ è§†è§‰è®¾è®¡è§„èŒƒ

### é¢œè‰²æ–¹æ¡ˆ

| å…ƒç´  | é¢œè‰² | Hex | ç”¨é€” |
|------|------|-----|------|
| ä»»åŠ¡åŸŸæ ‡ç­¾ | Cyan | #06B6D4 | ç­›é€‰å™¨æ ‡ç­¾ |
| å…³è”ç±»å‹æ ‡ç­¾ | Teal | #14B8A6 | ç­›é€‰å™¨æ ‡ç­¾ |
| å­¦ç”Ÿæ ‡ç­¾ | Indigo | #6366F1 | ç­›é€‰å™¨æ ‡ç­¾ |
| é€šç”¨ä»»åŠ¡ | Gray | #6B7280 | ä»»åŠ¡åŸŸæ ‡è¯† |
| å­¦ç”ŸæœåŠ¡ | Blue | #3B82F6 | ä»»åŠ¡åŸŸæ ‡è¯† |
| å…¬å¸è¿è¥ | Purple | #A855F7 | ä»»åŠ¡åŸŸæ ‡è¯† |
| å¸‚åœºè¥é”€ | Pink | #EC4899 | ä»»åŠ¡åŸŸæ ‡è¯† |
| çº¿ç´¢æ ‡è¯† | Pink | #EC4899 | å…³è”å¯¹è±¡ |
| å†å²æç¤º | Amber | #F59E0B | æç¤ºæ¨ªå¹… |

### å›¾æ ‡æ˜ å°„

| ä»»åŠ¡åŸŸ | å›¾æ ‡ | è¯´æ˜ |
|--------|------|------|
| general | Briefcase | å…¬æ–‡åŒ… - é€šç”¨ä»»åŠ¡ |
| student_success | Users | ç”¨æˆ·ç¾¤ - å­¦ç”ŸæœåŠ¡ |
| company_ops | Building2 | å»ºç­‘ - å…¬å¸è¿è¥ |
| marketing | Megaphone | æ‰©éŸ³å™¨ - å¸‚åœºè¥é”€ |

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1: æ‰§è¡Œæ•°æ®åº“è¿ç§» âš ï¸ å¿…é¡»

**æ–¹å¼1: Supabase Dashboardï¼ˆæ¨èï¼‰**

1. è®¿é—® SQL Editor:
   ```
   https://supabase.com/dashboard/project/swyajeiqqewyckzbfkid/sql
   ```

2. ç‚¹å‡» "New Query"

3. å¤åˆ¶ä»¥ä¸‹SQLå¹¶æ‰§è¡Œ:
   ```sql
   -- æ·»åŠ å­—æ®µ
   ALTER TABLE tasks ADD COLUMN IF NOT EXISTS task_domain VARCHAR(50) DEFAULT 'general';
   ALTER TABLE tasks ADD COLUMN IF NOT EXISTS linked_entity_type VARCHAR(20) DEFAULT 'none';
   ALTER TABLE tasks ADD COLUMN IF NOT EXISTS linked_entity_id INTEGER;
   
   -- åˆ›å»ºç´¢å¼•
   CREATE INDEX IF NOT EXISTS idx_tasks_domain ON tasks(task_domain);
   CREATE INDEX IF NOT EXISTS idx_tasks_linked_entity ON tasks(linked_entity_type, linked_entity_id);
   
   -- å›å¡«å†å²æ•°æ®
   UPDATE tasks 
   SET task_domain = 'student_success',
       linked_entity_type = 'student',
       linked_entity_id = related_student_id
   WHERE related_student_id IS NOT NULL AND task_domain = 'general';
   
   UPDATE tasks 
   SET task_domain = 'marketing',
       linked_entity_type = 'lead',
       linked_entity_id = related_lead_id
   WHERE related_lead_id IS NOT NULL AND task_domain = 'general';
   ```

4. ç‚¹å‡» "RUN" æ‰§è¡Œ

**æ–¹å¼2: ä½¿ç”¨å®Œæ•´è¿ç§»è„šæœ¬**

å¤åˆ¶æ•´ä¸ª `database_migrations/001_add_task_domain_and_linked_entity.sql` æ–‡ä»¶å†…å®¹å¹¶æ‰§è¡Œã€‚

### æ­¥éª¤2: éªŒè¯è¿ç§»

è¿è¡ŒéªŒè¯è„šæœ¬:
```bash
node database_migrations/run_migration.js
```

åº”è¯¥çœ‹åˆ°:
```
âœ… æ•°æ®åº“å·²å®Œæˆè¿ç§»ï¼

ğŸ“Š æ•°æ®åˆ†å¸ƒç»Ÿè®¡:
  ä»»åŠ¡åŸŸåˆ†å¸ƒ:
    general           : X
    student_success   : Y
    marketing         : Z
```

### æ­¥éª¤3: æ¸…é™¤å‰ç«¯ç¼“å­˜

```bash
# æ¸…é™¤æ„å»ºç¼“å­˜
rm -rf dist

# é‡æ–°å®‰è£…ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### æ­¥éª¤4: åŠŸèƒ½æµ‹è¯•

1. **ç­›é€‰åŠŸèƒ½æµ‹è¯•**
   - [ ] ä»»åŠ¡åŸŸç­›é€‰æ­£å¸¸
   - [ ] å…³è”ç±»å‹ç­›é€‰æ­£å¸¸
   - [ ] å­¦ç”Ÿç­›é€‰æ­£å¸¸
   - [ ] ç»„åˆç­›é€‰æ­£å¸¸

2. **ç»Ÿè®¡é¢æ¿æµ‹è¯•**
   - [ ] æŒ‰ä»»åŠ¡åŸŸåˆ†å¸ƒæ˜¾ç¤ºæ­£ç¡®
   - [ ] ç™¾åˆ†æ¯”è®¡ç®—å‡†ç¡®
   - [ ] å›¾æ ‡å’Œé¢œè‰²æ­£ç¡®

3. **è§†å›¾æµ‹è¯•**
   - [ ] è¡¨æ ¼è§†å›¾æ˜¾ç¤ºä»»åŠ¡åŸŸåˆ—
   - [ ] çœ‹æ¿è§†å›¾æ˜¾ç¤ºåŸŸå¾½ç« 
   - [ ] æ—¥å†è§†å›¾æ˜¾ç¤ºå½©è‰²è¾¹æ¡†

4. **å†å²æ•°æ®æç¤º**
   - [ ] æ¨ªå¹…æ­£ç¡®ç»Ÿè®¡é—ç•™ä»»åŠ¡
   - [ ] å¯ä»¥å…³é—­æ¨ªå¹…
   - [ ] æœ¬åœ°å­˜å‚¨è®°å¿†çŠ¶æ€

---

## ğŸ“Š åŠŸèƒ½è¯¦è§£

### 1. å¤šç»´åº¦ç­›é€‰

ç”¨æˆ·ç°åœ¨å¯ä»¥é€šè¿‡ä»¥ä¸‹ç»´åº¦ç­›é€‰ä»»åŠ¡ï¼š

| ç­›é€‰ç»´åº¦ | é€‰é¡¹ | ç”¨é€” |
|---------|------|------|
| ä»»åŠ¡åŸŸ | é€šç”¨/å­¦ç”Ÿ/è¿è¥/å¸‚åœº | æŒ‰ä¸šåŠ¡çº¿ç­›é€‰ |
| å…³è”ç±»å‹ | å­¦ç”Ÿ/çº¿ç´¢/å‘˜å·¥/æ—  | æŒ‰å…³è”å¯¹è±¡ç±»å‹ç­›é€‰ |
| å­¦ç”Ÿ | åŠ¨æ€åˆ—è¡¨ | ç­›é€‰ç‰¹å®šå­¦ç”Ÿçš„ä»»åŠ¡ |
| çŠ¶æ€ | å¾…å¤„ç†/è¿›è¡Œä¸­/å®Œæˆ/å–æ¶ˆ | æŒ‰çŠ¶æ€ç­›é€‰ |
| ä¼˜å…ˆçº§ | é«˜/ä¸­/ä½ | æŒ‰ä¼˜å…ˆçº§ç­›é€‰ |
| æ—¶é—´ | ä»Šå¤©/æ˜å¤©/æœ¬å‘¨/é€¾æœŸ | æŒ‰æ—¶é—´ç­›é€‰ |
| æ ‡ç­¾ | åŠ¨æ€åˆ—è¡¨ | æŒ‰æ ‡ç­¾ç­›é€‰ |

**ç»„åˆç­›é€‰**:
- æ”¯æŒåŒæ—¶ä½¿ç”¨å¤šä¸ªç­›é€‰æ¡ä»¶
- ç­›é€‰æ ‡ç­¾å®æ—¶æ˜¾ç¤º
- ä¸€é”®æ¸…é™¤æ‰€æœ‰ç­›é€‰

### 2. å¯è§†åŒ–ç»Ÿè®¡

#### ä¸»ç»Ÿè®¡é¢æ¿ï¼ˆç¬¬ä¸€è¡Œï¼‰
- å…¨éƒ¨ä»»åŠ¡
- å¾…å¤„ç†
- è¿›è¡Œä¸­
- å·²å®Œæˆ
- ä»Šå¤©åˆ°æœŸ
- å·²é€¾æœŸ

#### ä»»åŠ¡åŸŸåˆ†å¸ƒï¼ˆç¬¬äºŒè¡Œï¼‰
- é€šç”¨ä»»åŠ¡ï¼šæ•°é‡ + å æ¯”%
- å­¦ç”ŸæœåŠ¡ï¼šæ•°é‡ + å æ¯”%
- å…¬å¸è¿è¥ï¼šæ•°é‡ + å æ¯”%
- å¸‚åœºè¥é”€ï¼šæ•°é‡ + å æ¯”%

### 3. ä¸‰è§†å›¾ä¸€è‡´æ€§

#### åˆ—è¡¨è§†å›¾ï¼ˆTaskTableï¼‰
- âœ… ä¸“å±ä»»åŠ¡åŸŸåˆ—
- âœ… å›¾æ ‡ + æ–‡å­—æ ‡ç­¾
- âœ… å…³è”å¯¹è±¡åˆ—æ”¯æŒå­¦ç”Ÿ/çº¿ç´¢/å‘˜å·¥

#### çœ‹æ¿è§†å›¾ï¼ˆKanbanViewï¼‰
- âœ… å¡ç‰‡é¡¶éƒ¨æ˜¾ç¤ºä»»åŠ¡åŸŸå¾½ç« 
- âœ… å…³è”å¯¹è±¡åŒºå—ï¼ˆå¤´åƒ + åç§°ï¼‰
- âœ… çº¿ç´¢ç‰¹æ®Šæ ‡è¯†

#### æ—¥å†è§†å›¾ï¼ˆCalendarViewï¼‰
- âœ… å·¦ä¾§å½©è‰²è¾¹æ¡†æ ‡è¯†ä»»åŠ¡åŸŸ
  - è“è‰² = å­¦ç”ŸæœåŠ¡
  - ç´«è‰² = å…¬å¸è¿è¥
  - ç²‰è‰² = å¸‚åœºè¥é”€
  - ç°è‰² = é€šç”¨ä»»åŠ¡
- âœ… æ‚¬æµ®æ˜¾ç¤ºä»»åŠ¡åŸŸåç§°
- âœ… æ˜¾ç¤ºå…³è”å¯¹è±¡åç§°

### 4. å†å²æ•°æ®å…¼å®¹

#### LegacyTaskBanner ç»„ä»¶
- âœ… è‡ªåŠ¨æ£€æµ‹ç¼ºå°‘ä¿¡æ¯çš„ä»»åŠ¡
- âœ… æ˜¾ç¤ºç»Ÿè®¡ï¼š
  - X ä¸ªä»»åŠ¡ç¼ºå°‘ä»»åŠ¡åŸŸ
  - Y ä¸ªä»»åŠ¡ç¼ºå°‘å…³è”å¯¹è±¡
- âœ… æä¾›æ“ä½œæŒ‡å¼•
- âœ… æ”¯æŒå…³é—­å¹¶è®°å¿†çŠ¶æ€

---

## ğŸ“ˆ æ•°æ®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ›å»º/ç¼–è¾‘ä»»åŠ¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€‰æ‹©ä»»åŠ¡åŸŸ      â”‚ â†’ general / student_success / company_ops / marketing
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é€‰æ‹©å…³è”å¯¹è±¡ç±»å‹ â”‚ â†’ student / lead / employee / none
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é€‰æ‹©å…·ä½“å…³è”å¯¹è±¡ â”‚ â†’ å­¦ç”ŸID / çº¿ç´¢ID / å‘˜å·¥ID
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¿å­˜åˆ°æ•°æ®åº“    â”‚
â”‚  - task_domain   â”‚
â”‚  - linked_entity_type â”‚
â”‚  - linked_entity_id   â”‚
â”‚  - related_student_id â”‚ (å‘åå…¼å®¹)
â”‚  - related_lead_id    â”‚ (å‘åå…¼å®¹)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯å±•ç¤º        â”‚
â”‚  - ç­›é€‰å™¨        â”‚
â”‚  - ç»Ÿè®¡é¢æ¿      â”‚
â”‚  - ä¸‰è§†å›¾æ ‡è¯†    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯äº®ç‚¹

### 1. å‘åå…¼å®¹è®¾è®¡
- ä¿ç•™ `related_student_id` å’Œ `related_lead_id` å­—æ®µ
- æ–°æ—§å­—æ®µè‡ªåŠ¨åŒæ­¥
- å†å²æ•°æ®è‡ªåŠ¨è¿ç§»
- æ— ç¼å‡çº§ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½

### 2. æ€§èƒ½ä¼˜åŒ–
- æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
- useMemo ç¼“å­˜è®¡ç®—ç»“æœ
- åˆ†ç»„ç»Ÿè®¡é¿å…é‡å¤è®¡ç®—
- æœ¬åœ°å­˜å‚¨å‡å°‘çŠ¶æ€æŸ¥è¯¢

### 3. ç”¨æˆ·ä½“éªŒ
- å½©è‰²æ ‡ç­¾ç›´è§‚æ˜“è¯†åˆ«
- å›¾æ ‡è¾…åŠ©ç†è§£
- ä¸€é”®æ¸…é™¤ä¾¿æ·æ“ä½œ
- å®æ—¶ç»Ÿè®¡å³æ—¶åé¦ˆ
- å“åº”å¼å¸ƒå±€å¤šè®¾å¤‡é€‚é…

### 4. å¯æ‰©å±•æ€§
- ç»Ÿä¸€çš„ä»»åŠ¡åŸŸæ¨¡å‹
- çµæ´»çš„å…³è”å¯¹è±¡æœºåˆ¶
- ä¸ºAIåŠ©ç†é¢„ç•™æ¥å£
- æ”¯æŒæœªæ¥æ–°å¢ä¸šåŠ¡çº¿

---

## ğŸ“š æ–‡ä»¶æ¸…å•

### æ•°æ®åº“ç›¸å…³
- âœ… `database_migrations/001_add_task_domain_and_linked_entity.sql`
- âœ… `database_migrations/run_migration.js`
- âœ… `database_migrations/auto_migrate.js`

### ç±»å‹å®šä¹‰
- âœ… `src/pages/admin/TaskManagement/types/task.types.ts`

### ä¸šåŠ¡é€»è¾‘
- âœ… `src/pages/admin/TaskManagement/hooks/useTaskFilters.ts`

### UIç»„ä»¶
- âœ… `src/pages/admin/TaskManagement/components/TaskFilters/index.tsx`
- âœ… `src/pages/admin/TaskManagement/components/TaskStats/index.tsx`
- âœ… `src/pages/admin/TaskManagement/components/TaskTable/index.tsx`
- âœ… `src/pages/admin/TaskManagement/components/KanbanView/index.tsx`
- âœ… `src/pages/admin/TaskManagement/components/CalendarView/index.tsx`
- âœ… `src/pages/admin/TaskManagement/components/LegacyTaskBanner/index.tsx` (æ–°å»º)

### ä¸»é¡µé¢
- âœ… `src/pages/admin/TaskManagement/index.tsx`

### æ–‡æ¡£
- âœ… `TASK_DOMAIN_UPGRADE_SUMMARY.md`
- âœ… `ä»»åŠ¡æ¨¡å—å‡çº§å®ŒæˆæŠ¥å‘Š.md` (æœ¬æ–‡æ¡£)

---

## ğŸ§ª æµ‹è¯•æ¸…å•

### æ•°æ®åº“å±‚
- [ ] å­—æ®µæ·»åŠ æˆåŠŸ
- [ ] ç´¢å¼•åˆ›å»ºæˆåŠŸ
- [ ] å†å²æ•°æ®å›å¡«æ­£ç¡®
- [ ] çº¦æŸæ­£å¸¸å·¥ä½œ

### å‰ç«¯åŠŸèƒ½
- [ ] ä»»åŠ¡åŸŸç­›é€‰æ­£å¸¸
- [ ] å…³è”ç±»å‹ç­›é€‰æ­£å¸¸
- [ ] å­¦ç”Ÿç­›é€‰æ­£å¸¸
- [ ] ç»Ÿè®¡æ•°æ®å‡†ç¡®
- [ ] ä¸‰è§†å›¾æ ‡è¯†æ­£ç¡®
- [ ] å†å²æ¨ªå¹…æ˜¾ç¤º
- [ ] æ¨ªå¹…å…³é—­è®°å¿†

### å…¼å®¹æ€§
- [ ] æ—§ä»»åŠ¡æ­£å¸¸æ˜¾ç¤º
- [ ] æ–°å»ºä»»åŠ¡é€‰æ‹©åŸŸ
- [ ] ç¼–è¾‘ä»»åŠ¡æ›´æ–°åŸŸ
- [ ] æ•°æ®åŒæ­¥æ­£ç¡®

### æ€§èƒ½
- [ ] ç­›é€‰å“åº”å¿«é€Ÿ
- [ ] ç»Ÿè®¡è®¡ç®—æµç•…
- [ ] é¡µé¢åŠ è½½æ­£å¸¸
- [ ] æ— å†…å­˜æ³„æ¼

---

## ğŸ’¡ ä½¿ç”¨æŒ‡å—

### åˆ›å»ºä»»åŠ¡æ—¶
1. é€‰æ‹©ä»»åŠ¡åŸŸï¼ˆå¿…é€‰ï¼‰
2. é€‰æ‹©å…³è”å¯¹è±¡ç±»å‹ï¼ˆå¯é€‰ï¼‰
3. å¦‚æœé€‰æ‹©äº†å…³è”ç±»å‹ï¼Œé€‰æ‹©å…·ä½“å¯¹è±¡
4. ç³»ç»Ÿè‡ªåŠ¨ç»´æŠ¤æ–°æ—§å­—æ®µ

### ç­›é€‰ä»»åŠ¡æ—¶
1. ä½¿ç”¨ä»»åŠ¡åŸŸå¿«é€Ÿå®šä½ä¸šåŠ¡çº¿ä»»åŠ¡
2. ä½¿ç”¨å…³è”ç±»å‹æŸ¥çœ‹ç‰¹å®šç±»å‹çš„å…³è”
3. ç»“åˆå…¶ä»–ç­›é€‰æ¡ä»¶ç²¾ç¡®æŸ¥æ‰¾
4. æŸ¥çœ‹å·²é€‰ç­›é€‰æ ‡ç­¾ç¡®è®¤æ¡ä»¶

### æŸ¥çœ‹ç»Ÿè®¡æ—¶
1. é¡¶éƒ¨ç»Ÿè®¡é¢æ¿æŸ¥çœ‹æ•´ä½“æƒ…å†µ
2. ä»»åŠ¡åŸŸåˆ†å¸ƒäº†è§£ä¸šåŠ¡åˆ†å¸ƒ
3. æ ¹æ®ç™¾åˆ†æ¯”ä¼˜åŒ–èµ„æºåˆ†é…

### å¤„ç†å†å²ä»»åŠ¡
1. æŸ¥çœ‹æ¨ªå¹…äº†è§£é—ç•™ä»»åŠ¡æ•°é‡
2. ç‚¹å‡»ä»»åŠ¡è¿›å…¥ä¾§è¾¹æ 
3. ç¼–è¾‘ä»»åŠ¡åŸŸå’Œå…³è”å¯¹è±¡
4. ä¿å­˜æ›´æ–°

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®åº“è¿ç§»
1. **å¿…é¡»å…ˆæ‰§è¡Œæ•°æ®åº“è¿ç§»** SQLæ‰èƒ½ä½¿ç”¨æ–°åŠŸèƒ½
2. å»ºè®®åœ¨æ‰§è¡Œå‰å¤‡ä»½æ•°æ®
3. è¿ç§»åŒ…å«æ•°æ®å›å¡«ï¼Œå¯èƒ½éœ€è¦å‡ ç§’é’Ÿ
4. éªŒè¯è¿ç§»æˆåŠŸåå†éƒ¨ç½²å‰ç«¯

### å‰ç«¯éƒ¨ç½²
1. è¿ç§»å®Œæˆåéƒ¨ç½²å‰ç«¯ä»£ç 
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
3. åˆ·æ–°é¡µé¢æŸ¥çœ‹æ–°åŠŸèƒ½

### ç”¨æˆ·åŸ¹è®­
1. é€šçŸ¥å›¢é˜Ÿæ–°åŠŸèƒ½ä¸Šçº¿
2. è¯´æ˜ä»»åŠ¡åŸŸçš„å«ä¹‰å’Œç”¨é€”
3. æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ–°ç­›é€‰å™¨
4. æé†’å®Œå–„å†å²ä»»åŠ¡ä¿¡æ¯

---

## ğŸ”® æœªæ¥æ‰©å±•å»ºè®®

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰
- [ ] æ·»åŠ ä»»åŠ¡åŸŸåˆ‡æ¢çš„å¿«æ·é”®
- [ ] æ‰¹é‡æ›´æ–°å†å²ä»»åŠ¡çš„å·¥å…·
- [ ] ä»»åŠ¡åŸŸçš„é¢œè‰²è‡ªå®šä¹‰

### ä¸­æœŸï¼ˆ1ä¸ªæœˆï¼‰
- [ ] åŸºäºä»»åŠ¡åŸŸçš„æƒé™æ§åˆ¶
- [ ] ä»»åŠ¡åŸŸçš„SLAé…ç½®
- [ ] è‡ªåŠ¨ä»»åŠ¡åˆ†é…è§„åˆ™

### é•¿æœŸï¼ˆ3ä¸ªæœˆ+ï¼‰
- [ ] AIåŠ©ç†æ™ºèƒ½åˆ†ç±»ä»»åŠ¡
- [ ] è·¨åŸŸä»»åŠ¡åä½œæµç¨‹
- [ ] ä»»åŠ¡åŸŸç»©æ•ˆåˆ†ææŠ¥è¡¨

---

## ğŸ“ æ”¯æŒä¸åé¦ˆ

### æŠ€æœ¯é—®é¢˜
å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ•°æ®åº“è¿ç§»æ˜¯å¦æˆåŠŸæ‰§è¡Œ
2. æµè§ˆå™¨ç¼“å­˜æ˜¯å¦æ¸…é™¤
3. æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—

### åŠŸèƒ½å»ºè®®
æ¬¢è¿æå‡ºæ”¹è¿›å»ºè®®ï¼š
- æ–°çš„ä»»åŠ¡åŸŸç±»å‹
- æ–°çš„å…³è”å¯¹è±¡ç±»å‹
- æ–°çš„ç­›é€‰ç»´åº¦
- æ–°çš„ç»Ÿè®¡è§†å›¾

---

## âœ… éªŒæ”¶æ¸…å•

### ä»£ç è´¨é‡
- [x] TypeScript ç±»å‹å®Œæ•´
- [x] æ—  Linter é”™è¯¯
- [x] ä»£ç æ³¨é‡Šå®Œæ•´
- [x] éµå¾ªé¡¹ç›®è§„èŒƒ

### åŠŸèƒ½å®Œæ•´æ€§
- [x] æ•°æ®åº“è¿ç§»SQL
- [x] ç±»å‹å®šä¹‰æ‰©å±•
- [x] ç­›é€‰é€»è¾‘å®ç°
- [x] UIç»„ä»¶æ›´æ–°
- [x] ç»Ÿè®¡åŠŸèƒ½å®Œå–„
- [x] ä¸‰è§†å›¾æ ‡è¯†
- [x] å†å²æ•°æ®æç¤º

### æ–‡æ¡£å®Œæ•´æ€§
- [x] è¿ç§»æŒ‡å—
- [x] ä½¿ç”¨æ‰‹å†Œ
- [x] æŠ€æœ¯æ–‡æ¡£
- [x] éªŒæ”¶æ¸…å•

---

## ğŸ‰ æ€»ç»“

### ä¸»è¦æˆå°±

1. **æ•°æ®æ¨¡å‹å‡çº§** - ä»å•ä¸€å…³è”å‡çº§åˆ°å¤šä¸šåŠ¡çº¿æ¨¡å‹
2. **ç­›é€‰èƒ½åŠ›å¢å¼º** - ä»5ä¸ªç»´åº¦å¢åŠ åˆ°7ä¸ªç»´åº¦
3. **å¯è§†åŒ–æå‡** - æ–°å¢ä»»åŠ¡åŸŸåˆ†å¸ƒç»Ÿè®¡
4. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–** - å½©è‰²æ ‡ç­¾ã€å›¾æ ‡è¾…åŠ©ã€å†å²æç¤º
5. **å‘åå…¼å®¹** - å¹³æ»‘å‡çº§ï¼Œä¸å½±å“ç°æœ‰æ•°æ®

### å…³é”®æ•°æ®

- **ä¿®æ”¹æ–‡ä»¶**: 9ä¸ª
- **æ–°å»ºæ–‡ä»¶**: 4ä¸ª
- **æ–°å¢ä»£ç **: ~800è¡Œ
- **æ–°å¢åŠŸèƒ½**: 7ä¸ª
- **æ€§èƒ½ä¼˜åŒ–**: 3å¤„ç´¢å¼•
- **UIæ”¹è¿›**: 4ä¸ªç»„ä»¶

### å›¢é˜Ÿä»·å€¼

1. **æå‡æ•ˆç‡**: ç²¾å‡†ç­›é€‰å‡å°‘æŸ¥æ‰¾æ—¶é—´
2. **æ•°æ®æ´å¯Ÿ**: ä»»åŠ¡åŸŸåˆ†å¸ƒè¾…åŠ©å†³ç­–
3. **è§„èŒƒæµç¨‹**: ç»Ÿä¸€çš„ä»»åŠ¡åˆ†ç±»æ ‡å‡†
4. **æ‰©å±•åŸºç¡€**: ä¸ºæœªæ¥åŠŸèƒ½é“ºå¹³é“è·¯

---

**å¼€å‘å®Œæˆ**: âœ…  
**ä»£ç æ£€æŸ¥**: âœ… æ— é”™è¯¯  
**æ–‡æ¡£å®Œæ•´**: âœ…  
**å¾…æ‰§è¡Œ**: âš ï¸ æ•°æ®åº“è¿ç§»SQL

---

## ğŸš¦ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œï¼ˆä»Šå¤©ï¼‰
1. âš ï¸ **æ‰§è¡Œæ•°æ®åº“è¿ç§»SQL**ï¼ˆæœ€é‡è¦ï¼‰
2. è¿è¡ŒéªŒè¯è„šæœ¬ç¡®è®¤è¿ç§»æˆåŠŸ
3. æ¸…é™¤å‰ç«¯ç¼“å­˜

### æœ¬å‘¨å®Œæˆ
1. æµ‹è¯•æ‰€æœ‰æ–°åŠŸèƒ½
2. åŸ¹è®­å›¢é˜Ÿæˆå‘˜
3. æ”¶é›†ç”¨æˆ·åé¦ˆ

### æŒç»­ä¼˜åŒ–
1. ç›‘æ§æ€§èƒ½æŒ‡æ ‡
2. å®Œå–„å†å²ä»»åŠ¡ä¿¡æ¯
3. è§„åˆ’ä¸‹ä¸€é˜¶æ®µåŠŸèƒ½

---

**æ„Ÿè°¢ä½¿ç”¨ï¼å¦‚æœ‰é—®é¢˜è¯·éšæ—¶åé¦ˆ** ğŸ™

